# vagalumeR: Access the Vagalume API via R #

This package allows you to access the Vagalume API via R. You can get
information about specific artists/bands, as their related artists,
and information about the lyrics, as the top lyrics of an artist/band
and the text of a song itself. 


The `vagalumeR` package is developed under control version using Git 
and is hosted in GitHub. You can download it from GitHub using `devtools`:
```{r, eval=FALSE}
# install.packages("devtools")
devtools::install_github("brunaw/vagalumeR")
```

For exploring the content of the package, you may try:
```{r, eval=FALSE}
library(vagalumeR)
packageVersion("vagalumeR")
ls("package:vagalumeR")
help(package = "vagalumeR")
```

------------------------------------------------------------------------

Some examples of the usage of this package are above:
```{r, echo = FALSE, message=FALSE}
library(vagalumeR)
```

```{r, message=FALSE}
artists <- c("the-beatles", "madonna", "chico-buarque",
             "the-rolling-stones", "molejo")

library(tidyverse)
library(plyr)

ldply(map(artists, artistInfo), data.frame)

#                  id           name  views pos period uniques points
# 1 3ade68b3gce86eda3    The Beatles 115586  24 201706   57221   42.5
# 2 3ade68b3g1f86eda3        Madonna   1519 169 201707     767   10.9
# 3 3ade68b4g66c6eda3  Chico Buarque   4603 109 201707    2124   15.2
# 4 3ade68b6g28c9eda3 Rolling Stones  28633 265 201706   15997    7.1
# 5 3ade68b5g2f48eda3         Molejo   7843 826 201706    4652    1.9
```

Where:

  - `id` is the identifier of the artist/band;
  - `name` is the name of  the artist/band;
  - `views` is the number of views received by the artist/band at the
  Vagalume Website;
  - `pos` is the position of the artist/band at the Vagalume Ranking;
  - `period` is the period of evaluation;
  - `uniques` counts the number of unique views of the artist/band;
  - `points` is the pontuation of the artist/band at the Vagalume 
  Ranking;

```{r, message=FALSE}
disc <- ldply(map(artists, discography), data.frame)

disc[sample(nrow(disc), 10), ]

#              album.id                     album.name
# 32  3ade68b6g9758fda3         Sticky and Sweet: Live
# 155 3ade68b6g94c7fda3                   Polivalência
# 36  3ade68b6g8408fda3 I'm Going to Tell You a Secret
# 25  3ade68b6g5ff5fda3               Beatles for Sale
# 147 3ade68b6gcd18fda3       The Rolling Stones No. 2
# 38  3ade68b6g1a14fda3            Remixed & Revisited
# 27  3ade68b6g3ff5fda3               With the Beatles
# 90  3ade68b6gf8d6fda3              Meus Caros Amigos
# 89  3ade68b6g3638fda3                  Chico Buarque
# 109 3ade68b6g9166fda3                       Stripped
#                      label date                id           name
# 32                Maverick 2010 3ade68b3g1f86eda3        Madonna
# 155                        2000 3ade68b5g2f48eda3         Molejo
# 36                     wea 2006 3ade68b3g1f86eda3        Madonna
# 25                     EMI 1964 3ade68b3gce86eda3    The Beatles
# 147                  DECCA 1965 3ade68b6g28c9eda3 Rolling Stones
# 38                     wea 2003 3ade68b3g1f86eda3        Madonna
# 27                     EMI 1963 3ade68b3gce86eda3    The Beatles
# 90         Universal Music 1976 3ade68b4g66c6eda3  Chico Buarque
# 89  Universal Music Brasil 1978 3ade68b4g66c6eda3  Chico Buarque
# 109                        1995 3ade68b6g28c9eda3 Rolling Stones

xtabs(~name, disc)
# name
#  Chico Buarque        Madonna         Molejo Rolling Stones 
#             44             27              8             50 
#    The Beatles 
#             28 
```

Where:

  - `album.id` is the identifier of album;
  - `album.name` is the name of  the album;
  - `label` is the record label of the album;
  - `date` is the of release of the album;

```{r, message=FALSE}
rel <- ldply(map(artists, relatedInfo), data.frame)

rel[sample(nrow(rel), 10), ]
#                   id           name            rel.id
# 23 3ade68b4g66c6eda3  Chico Buarque 3ade68b5gac58eda3
# 24 3ade68b4g66c6eda3  Chico Buarque 3ade68b5gfe48eda3
# 38 3ade68b6g28c9eda3 Rolling Stones 3ade68b5gc5a8eda3
# 42 3ade68b5g2f48eda3         Molejo 3ade68b3g9d86eda3
# 28 3ade68b4g66c6eda3  Chico Buarque 3ade68b5g65d7eda3
# 1  3ade68b3gce86eda3    The Beatles 3ade68b3gee86eda3
# 34 3ade68b6g28c9eda3 Rolling Stones 3ade68b5g5018eda3
# 5  3ade68b3gce86eda3    The Beatles 3ade68b6g28c9eda3
# 26 3ade68b4g66c6eda3  Chico Buarque 3ade68b5g7d48eda3
# 13 3ade68b3g1f86eda3        Madonna 3ade68b5g8be7eda3
#                         related
# 23                    Tom Jobim
# 24            Milton Nascimento
# 38                Elvis Presley
# 42                  Art Popular
# 28                 Zeca Baleiro
# 1                   John Lennon
# 34 Creedence Clearwater Revival
# 5                Rolling Stones
# 26               Maria Bethânia
# 13              Michael Jackson
```
Where:

  - `rel.id` is the identifier of the related band/artist;
  - `related` is the name of the related band/artist;


```{r, message=FALSE}
#---------
library(network)
df <- data.frame(rel$name, rel$related)
net <- network(df)
plot(net, label = network.vertex.names(net))
```

```{r, message=FALSE}
songs <- ldply(map(artists, songNames), data.frame)

songs[sample(nrow(songs), 10), ]
```

Where:

  - `song.id` is the identifier of the song;
  - `song` is the name of the song;

```{r, message=FALSE}
lyr <- ldply(map(songs$song.id[1:5], lyrics, type = "id"), data.frame)

lyr[sample(nrow(lyr), 2), ]
```

Where:

  - `language` is the language of the song;
  - `song` is the name of the song;
  - `language` is the language of the song (1 = portuguese,
  2 = english)
  - `text` is the lyrics text of the song;
  - `tr.text` is the translation text of the song;

```{r, message=FALSE}
library(tm)
# Creates the Corpus
m <- lyr[lyr$name == "The Beatles", ]

cps <- VCorpus(VectorSource(m$text),
                 readerControl = list(language = "en"))

cps <- tm_map(cps, FUN = content_transformer(tolower))
cps <- tm_map(cps, FUN = removePunctuation)
cps <- tm_map(cps, FUN = removeNumbers)
cps <- tm_map(cps, FUN = stripWhitespace)
cps <- tm_map(cps,
                FUN = removeWords,
                words = stopwords("english"))
dtm <- DocumentTermMatrix(cps)

frq <- slam::colapply_simple_triplet_matrix(dtm, FUN = sum)
frq <- sort(frq, decreasing = TRUE)

library(lattice)
# Shows the most common words in songs from The Beatles
barchart(head(frq, n = 45), xlim = c(0, NA),
          col =  "violet", 
          xlab = "Frequency",
          ylab = "Words",
          strip = strip.custom(bg = "white"))
```


